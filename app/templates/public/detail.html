{% extends 'base.html' %}

{% block content %}
<div class="container my-5">
    <a href="{{ url_for('public.index') }}" class="btn btn-sm btn-outline-secondary mb-3">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    
    {% if not prop %}
    <div class="alert alert-danger">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
    {% else %}

    <div class="row">
        <div class="col-lg-8">
            <h1 class="mb-3">{{ prop.dorm_name }}</h1>

            <div id="propertyCarousel" class="carousel slide mb-4" data-bs-ride="carousel">
                <div class="carousel-inner rounded shadow-sm">
                    {# üí° ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ Prop.images ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î (‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÉ‡∏ô Model) #}
                    {% for img in prop.images %}
                    <div class="carousel-item {% if loop.first %}active{% endif %}">
                        {# üí° ‡πÉ‡∏ä‡πâ‡∏û‡∏≤‡∏ò‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤ img.file_path ‡∏Ñ‡∏∑‡∏≠ 'uploads/...') #}
                        <img src="/{{ img.file_path }}" class="d-block w-100" alt="{{ prop.dorm_name }}" style="height: 450px; object-fit: cover;">
                    </div>
                    {% else %}
                    <div class="carousel-item active">
                        <div class="d-flex justify-content-center align-items-center bg-light text-muted" style="height: 450px;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</div>
                    </div>
                    {% endfor %}
                </div>
                
                {% if prop.images|length > 1 %}
                <button class="carousel-control-prev" type="button" data-bs-target="#propertyCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#propertyCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
                {% endif %}
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏≠‡∏û‡∏±‡∏Å</h5>
                    <p class="card-text" style="white-space: pre-wrap;">{{ prop.description or '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°' }}</p>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><strong>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</strong> <span class="float-end text-primary h6">{{ "{:,.0f}".format(prop.rent_price) if prop.rent_price is not none else 'N/A' }} ‡∏ö‡∏≤‡∏ó</span></li>
                        <li class="list-group-item"><strong>‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô:</strong> <span class="float-end">{{ "{:,.0f}".format(prop.deposit_amount) if prop.deposit_amount is not none else 'N/A' }} ‡∏ö‡∏≤‡∏ó</span></li>
                        <li class="list-group-item"><strong>‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥:</strong> <span class="float-end">{{ prop.water_rate or 'N/A' }} ‡∏ö‡∏≤‡∏ó</span></li>
                        <li class="list-group-item"><strong>‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü:</strong> <span class="float-end">{{ prop.electric_rate or 'N/A' }} ‡∏ö‡∏≤‡∏ó</span></li>
                    </ul>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å</h5>
                    {% if prop.amenities.all() %}
                        {% for amenity in prop.amenities %}
                            <span class="badge bg-info text-dark me-2 mb-1">{{ amenity.label_th }}</span>
                        {% endfor %}
                    {% else %}
                        <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å</p>
                    {% endif %}
                </div>
            </div>

             <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h5>
                    <p class="card-text">{{ prop.additional_info or '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°' }}</p>
                </div>
            </div>

        </div>

        <div class="col-lg-4">
            <div class="card sticky-top shadow-lg" style="top: 20px;">
                <div class="card-body">
                    <h5 class="card-title text-success">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</h5>
                    <p class="mb-2"><strong>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> <a href="tel:{{ prop.contact_phone }}">{{ prop.contact_phone or 'N/A' }}</a></p>
                    <p class="mb-2"><strong>LINE ID:</strong> {{ prop.line_id or 'N/A' }}</p>
                    <p class="mb-2"><strong>Facebook:</strong> <a href="{{ prop.facebook_url }}" target="_blank">{{ prop.facebook_url or 'N/A' }}</a></p>
                    
                    <hr>
                    <h6 class="mt-3">‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á</h6>
                    <p class="card-text">{{ prop.address or 'N/A' }}, ‡∏ã‡∏≠‡∏¢ {{ prop.soi or 'N/A' }}, ‡∏ñ‡∏ô‡∏ô {{ prop.road or 'N/A' }}</p>
                    <p class="card-text">{{ prop.district or 'N/A' }}, {{ prop.province or 'N/A' }} {{ prop.postal_code }}</p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}