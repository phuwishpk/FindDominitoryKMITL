{% extends 'public/public_base.html' %}


{% block content %}

<header class="header" style="background-image: linear-gradient(rgba(15, 26, 44, 0.5), rgba(15, 26, 44, 0.5)), url({{ url_for('static', filename='images/header.jpg') }});">
  <div class="section__container header__container">
    <p class="section__subheader">FIND DORMITORY</p>
    <h1>หอพักที่สมบูรณ์แบบ<br />สำหรับคุณ</h1>
    <a href="#dorm-list" class="btn">ดูหอพักทั้งหมด</a>
  </div>
</header>

<section class="booking">
  <div class="section__container booking__container">
    <form action="{{ url_for('public.index') }}">
      <div class="input__group">
        <label for="q">ชื่อหอพัก</label>
        <input type="text" name="q" placeholder="ค้นหาตามชื่อ..." />
      </div>
      <div class="input__group">
        <label for="min_price">ราคาต่ำสุด</label>
        <input type="text" name="min_price" placeholder="เช่น 3000" />
      </div>
      <div class="input__group">
        <label for="max_price">ราคาสูงสุด</label>
        <input type="text" name="max_price" placeholder="เช่น 6000" />
      </div>
      <button class="btn">ค้นหา</button>
    </form>
  </div>
</section>

<section class="room__container" id="dorm-list">
  <p class="section__subheader">DORMITORIES</p>
  <h2 class="section__header">รายการประกาศหอพัก</h2>
  
  <div class="room__grid">
    {% for p in items %}
      <a href="{{ url_for('public.property_detail', prop_id=p.id) }}" class="room__card">
        {% set first_image = p.images|sort(attribute='position')|first %}
        {% if first_image %}
          <img src="/{{ first_image.file_path }}" alt="{{ p.dorm_name }}">
        {% else %}
          <img src="https://via.placeholder.com/400x250?text=No+Image" alt="No Image">
        {% endif %}
        
        <div class="room__card__details">
          <div>
            <h4>{{ p.dorm_name }}</h4>
            <p>{{ p.room_type }}</p>
            {% if p.availability_status == 'vacant' %}
                <p style="color: green;">สถานะ: ว่าง</p>
            {% else %}
                <p style="color: red;">สถานะ: เต็ม</p>
            {% endif %}
          </div>
          <h3>{{ "{:,.0f}".format(p.rent_price) if p.rent_price is not none else 'N/A' }}<span>/เดือน</span></h3>
        </div>
      </a>
    {% else %}
      <div class="alert alert-secondary w-100">ไม่พบข้อมูลประกาศในขณะนี้</div>
    {% endfor %}
  </div>
</section>

{% endblock %}