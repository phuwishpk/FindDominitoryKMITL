<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>{% if dorm %}Dorm Details{% else %}Add Dorm{% endif %}</title>
  <link rel="stylesheet" href="{{ url_for('owner.static', filename='owner.css') }}">
</head>
<body>
  {% if dorm %}
    <h1>รายละเอียดหอพัก (ID: {{ dorm.id }})</h1>
    <p><a href="{{ url_for('owner.dashboard') }}">&larr; กลับ</a> | <a href="{{ url_for('owner.logout') }}">Logout</a></p>

    <ul>
      <li>ชื่อ: {{ dorm.name }}</li>
      <li>น้ำ: {{ dorm.water_fee }}</li>
      <li>ไฟฟ้า: {{ dorm.electricity_fee }}</li>
      <li>มัดจำ: {{ dorm.deposit }}</li>
      <li>LINE: {{ dorm.contact_line }}</li>
      <li>โทร: {{ dorm.contact_phone }}</li>
      <li>พิกัด: {{ dorm.location_lat }}, {{ dorm.location_long }}</li>
      <li>สถานะ: {% if dorm.is_approved==2 %}Pending{% elif dorm.is_approved==1 %}Approved{% else %}Rejected{% endif %}</li>
      {% if dorm.rejection_reason %}<li>เหตุผลปฏิเสธ: {{ dorm.rejection_reason }}</li>{% endif %}
    </ul>

    <h3>เพิ่มห้อง</h3>
    <form method="post" action="{{ url_for('owner.add_room', dorm_id=dorm.id) }}">
      <label>ประเภทห้อง: <input name="room_type" required></label><br>
      <label>ราคา: <input name="price" type="number" step="0.01" value="0" required></label><br>
      <label>จำนวนห้อง: <input name="room_count" type="number" value="1" required></label><br>
      <label>ภาพ (URL): <input name="images"></label><br>
      <label>ภาพ (เพิ่มได้): <input name="images"></label><br>
      <button type="submit">บันทึกห้อง</button>
    </form>

    <h3>ห้องพัก</h3>
    {% if rooms|length == 0 %}
      <p>ยังไม่มีห้อง</p>
    {% else %}
      <table border="1" cellpadding="6">
        <tr><th>ID</th><th>Type</th><th>Price</th><th>Count</th><th>Images(JSON)</th></tr>
        {% for r in rooms %}
        <tr>
          <td>{{ r.id }}</td>
          <td>{{ r.room_type }}</td>
          <td>{{ r.price }}</td>
          <td>{{ r.room_count }}</td>
          <td>{{ r.images }}</td>
        </tr>
        {% endfor %}
      </table>
    {% endif %}

    <h3>ส่งคำขออนุมัติ</h3>
    <form method="post" action="{{ url_for('owner.approve_dorm', dorm_id=dorm.id) }}">
      <button type="submit">ตั้งเป็น Pending</button>
    </form>
  {% else %}
    <h1>เพิ่มหอพักใหม่</h1>
    <p><a href="{{ url_for('owner.dashboard') }}">&larr; กลับ</a></p>
    <form method="post" action="{{ url_for('owner.add_dorm') }}">
      <label>ชื่อหอพัก: <input name="dorm_name" required></label><br>
      <label>ค่าน้ำ: <input name="water_fee" type="number" step="0.01" value="0"></label><br>
      <label>ค่าไฟ: <input name="electricity_fee" type="number" step="0.01" value="0"></label><br>
      <label>ค่ามัดจำ: <input name="deposit" type="number" step="0.01" value="0"></label><br>
      <label>LINE: <input name="contact_line"></label><br>
      <label>โทร: <input name="contact_phone"></label><br>
      <label>Lat: <input name="location_lat" type="number" step="0.000001" required></label><br>
      <label>Long: <input name="location_long" type="number" step="0.000001" required></label><br>
      <button type="submit">บันทึก</button>
    </form>
  {% endif %}
</body>
</html>
